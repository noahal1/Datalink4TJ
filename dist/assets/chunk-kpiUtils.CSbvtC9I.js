import{_ as e}from"./entry-index.D92NaooR.js";import{V as a,e as t,f as l,ah as s,$ as o,v as n,g as c,z as u,A as d,ab as i,Z as _,h as r,j as m,k as p,l as v}from"./chunk-vue-core.CxEQweee.js";import{d as x,r as f,w as y,ae as g,ac as V,ad as b,H as h,K as F,a4 as k,X as j,J as w}from"./chunk-vendors.D0_dqILu.js";const U={class:"text-body-2"},K={class:"text-h6 text-primary"},z={class:"text-h6 text-success"},C={class:"mb-4"},S={class:"d-flex align-center mb-3"},$=e({__name:"KpiRemarkDialog",props:{modelValue:{type:Boolean,default:!1},item:{type:Object,default:null},title:{type:String,default:"原因分析与行动计划"}},emits:["update:modelValue","save"],setup(e,{emit:$}){const A=e,B=$,D=x({get:()=>A.modelValue,set:e=>B("update:modelValue",e)}),H=f({root_cause_analysis:"",action_plan_content:"",expected_close_date:"",actual_close_date:""});y((()=>A.item),(e=>{e&&(H.value={root_cause_analysis:e.root_cause_analysis||"",action_plan_content:e.action_plan_content||"",expected_close_date:e.expected_close_date||"",actual_close_date:e.actual_close_date||""})}),{immediate:!0}),x((()=>!0));const I=e=>null==e?"-":"string"==typeof e?e:"number"==typeof e?e.toFixed(2):String(e),J=()=>{var e,a;if(!(null==(e=A.item)?void 0:e.actual_value)||!(null==(a=A.item)?void 0:a.target_value))return"text-grey";return(parseFloat(A.item.actual_value)||0)>=(parseFloat(A.item.target_value)||0)?"text-success":"text-error"},O=()=>{var e,a;if(!(null==(e=A.item)?void 0:e.actual_value)||!(null==(a=A.item)?void 0:a.target_value))return"-";const t=(parseFloat(A.item.actual_value)||0)-(parseFloat(A.item.target_value)||0);return t>=0?`+${t.toFixed(2)}`:t.toFixed(2)},R=()=>{B("save",{root_cause_analysis:H.value.root_cause_analysis,action_plan_content:H.value.action_plan_content,expected_close_date:H.value.expected_close_date,actual_close_date:H.value.actual_close_date,item:A.item}),D.value=!1},X=()=>{A.item&&(H.value={root_cause_analysis:A.item.root_cause_analysis||"",action_plan_content:A.item.action_plan_content||"",expected_close_date:A.item.expected_close_date||"",actual_close_date:A.item.actual_close_date||""}),D.value=!1};return(x,f)=>(V(),g(v,{modelValue:D.value,"onUpdate:modelValue":f[4]||(f[4]=e=>D.value=e),"max-width":"800px",persistent:""},{default:b((()=>[h(a,null,{default:b((()=>[h(t,{class:"d-flex align-center"},{default:b((()=>[h(l,{class:"mr-2",color:"warning"},{default:b((()=>f[5]||(f[5]=[k(" mdi-alert-circle ")]))),_:1,__:[5]}),F("span",null,j(e.title),1)])),_:1}),h(s,{class:"pb-2"},{default:b((()=>{var a;return[h(o,{color:"primary",size:"small",class:"mr-2"},{default:b((()=>{var a;return[k(j(null==(a=e.item)?void 0:a.area),1)]})),_:1}),F("span",U,j(null==(a=e.item)?void 0:a.description),1)]})),_:1}),h(n),h(c,{class:"pt-4"},{default:b((()=>[h(u,{class:"mb-4"},{default:b((()=>[h(d,{cols:"4"},{default:b((()=>[h(a,{variant:"outlined",class:"text-center pa-3"},{default:b((()=>{var a;return[f[6]||(f[6]=F("div",{class:"text-caption text-grey"}," 实际值 ",-1)),F("div",K,j(I(null==(a=e.item)?void 0:a.actual_value)),1)]})),_:1,__:[6]})])),_:1}),h(d,{cols:"4"},{default:b((()=>[h(a,{variant:"outlined",class:"text-center pa-3"},{default:b((()=>{var a;return[f[7]||(f[7]=F("div",{class:"text-caption text-grey"}," 目标值 ",-1)),F("div",z,j(I(null==(a=e.item)?void 0:a.target_value)),1)]})),_:1,__:[7]})])),_:1}),h(d,{cols:"4"},{default:b((()=>[h(a,{variant:"outlined",class:"text-center pa-3"},{default:b((()=>[f[8]||(f[8]=F("div",{class:"text-caption text-grey"}," 差异 ",-1)),F("div",{class:w(["text-h6",J()])},j(O()),3)])),_:1,__:[8]})])),_:1})])),_:1}),h(i,{modelValue:H.value.root_cause_analysis,"onUpdate:modelValue":f[0]||(f[0]=e=>H.value.root_cause_analysis=e),label:"原因分析",placeholder:"请分析造成未达成目标的根本原因...",variant:"outlined",rows:"4",counter:"500",maxlength:"500",class:"mb-4","prepend-inner-icon":"mdi-magnify"},null,8,["modelValue"]),F("div",C,[F("div",S,[h(l,{class:"mr-2",color:"primary"},{default:b((()=>f[9]||(f[9]=[k("mdi-clipboard-list")]))),_:1,__:[9]}),f[10]||(f[10]=F("span",{class:"text-h6"},"行动计划",-1))]),h(i,{modelValue:H.value.action_plan_content,"onUpdate:modelValue":f[1]||(f[1]=e=>H.value.action_plan_content=e),label:"行动计划内容",placeholder:"请制定具体的改进行动计划...",variant:"outlined",rows:"4",counter:"500",maxlength:"500",class:"mb-3"},null,8,["modelValue"]),h(u,null,{default:b((()=>[h(d,{cols:"6"},{default:b((()=>[h(_,{modelValue:H.value.expected_close_date,"onUpdate:modelValue":f[2]||(f[2]=e=>H.value.expected_close_date=e),label:"预计关闭日期",type:"date",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])),_:1}),h(d,{cols:"6"},{default:b((()=>[h(_,{modelValue:H.value.actual_close_date,"onUpdate:modelValue":f[3]||(f[3]=e=>H.value.actual_close_date=e),label:"实际关闭日期",type:"date",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])),_:1})])),_:1})])])),_:1}),h(n),h(r,{class:"pa-4"},{default:b((()=>[h(m),h(p,{variant:"text",onClick:X},{default:b((()=>f[11]||(f[11]=[k(" 取消 ")]))),_:1,__:[11]}),h(p,{color:"primary",variant:"flat",onClick:R},{default:b((()=>f[12]||(f[12]=[k(" 保存 ")]))),_:1,__:[12]})])),_:1})])),_:1})])),_:1},8,["modelValue"]))}},[["__scopeId","data-v-e49bad34"]]),A=e=>{if(!e)return!1;const a=e.root_cause_analysis&&e.root_cause_analysis.trim(),t=e.action_plan_content&&e.action_plan_content.trim();return a||t};export{$ as K,A as h};
