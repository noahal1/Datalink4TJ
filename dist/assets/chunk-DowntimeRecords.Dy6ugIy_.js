import{u as e,a,U as l,d as t,l as n,M as i}from"./entry-index.D92NaooR.js";import{V as u,g as o,a9 as s,k as d,B as r,av as c,j as m,Z as v,z as _,A as f,$ as y,f as p,a2 as h,l as g,e as N,a1 as b,W as w,aa as k,h as D}from"./chunk-vue-core.CxEQweee.js";import{r as x,d as E,N as A,an as V,ae as R,ac as I,ad as C,H as T,af as L,K as S,ab as M,a4 as U,F as P,ag as W,X as $,I as H,W as j}from"./chunk-vendors.D0_dqILu.js";import"./chunk-utils-vendor.DVew6AbD.js";import"./chunk-chart-core.HkgdsJMe.js";const z={class:"d-flex align-center flex-wrap"},O={class:"d-flex align-center me-4 mb-2"},F={class:"d-flex align-center me-4 mb-2"},B={class:"d-flex align-center mb-2"},Q={class:"d-flex mb-2"},Y={class:"filter-tags d-flex align-center flex-wrap"},K={class:"d-flex align-center"},G={class:"text-h6"},J={class:"d-flex align-center"},X={class:"text-h6"},Z={class:"d-flex align-center"},q={class:"text-h6"},ee={key:0,class:"d-flex align-center mb-3"},ae={key:0,class:"mb-4 text-body-2"},le={class:"text-h6"},te={__name:"DowntimeRecords",setup(te){e(),a();const ne=[{title:"线体",key:"line",sortable:!0},{title:"停机类型",key:"type_name",sortable:!0},{title:"停机原因",key:"reason_name",sortable:!0},{title:"开始时间",key:"start_time",sortable:!0},{title:"结束时间",key:"end_time",sortable:!0},{title:"持续时间",key:"duration",sortable:!1},{title:"班次",key:"shift",sortable:!0},{title:"操作",key:"actions",sortable:!1,align:"center"}],ie=[{value:"SWI-L",title:"SWI-L"},{value:"SWI-R",title:"SWI-R"},{value:"RWH-L",title:"RWH-L"},{value:"RWH-R",title:"RWH-R"},{value:"W01",title:"W01"},{value:"HF",title:"HF"},{value:"LC",title:"LC"}],ue=x([]),oe=x([]),se=x(""),de=x({line:"",dateRange:[],shift:""}),re=x(!1),ce=E((()=>de.value.dateRange&&2===de.value.dateRange.length?`${de.value.dateRange[0]} 至 ${de.value.dateRange[1]}`:"选择日期范围")),me=x([]),ve=x(!1),_e=x(!1),fe=x(!1),ye=x(!1),pe=x(!1),he=x(-1),ge=x(null),Ne=E((()=>pe.value?"停机单详情查看":-1===he.value?"新建停机单":"编辑停机单")),be=e=>{if(!e)return"";if("string"==typeof e)try{e=new Date(e)}catch(a){return e}if(!(e instanceof Date)||isNaN(e))return"";return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},we=e=>{if(!e)return"白班";const a=new Date(e),l=a.getHours(),t=a.getMinutes();return(l>7||7===l&&t>=30)&&(l<19||19===l&&t<=30)?"白班":"夜班"};function ke(){const e=new Date,a=be(e),l=we(a),t="白班"===l?1:2;return{down_id:null,line:"",type_code:"PLANNED",type_name:"计划停机",reason_code:"",reason_name:"",start_time:a,end_time:be(e),remark:"",shift:l,shift_code:t}}const De=x(ke()),xe=()=>{de.value={line:"",dateRange:[],shift:""},se.value="",Ee()},Ee=async()=>{try{ve.value=!0;const l={skip:0,limit:100};if(de.value.line&&(l.line=de.value.line),de.value.shift&&(l.shift=de.value.shift),de.value.dateRange&&2===de.value.dateRange.length)try{const e=new Date(de.value.dateRange[0]);e.setHours(0,0,0,0);const a=new Date(de.value.dateRange[1]);a.setHours(23,59,59,999),l.start_from=e.toISOString(),l.start_to=a.toISOString()}catch(e){}try{me.value=[];Date.now();const e=await n.getDowntimeRecords(l);Date.now();if(e&&e.items){const a=e.items||[];me.value=a.map((e=>{let a=e.shift;a||(a=e.shift_code?1===e.shift_code?"白班":"夜班":we(e.start_time));let l=e.shift_code;return l||(l="白班"===a?1:2),{...e,shift:a,shift_code:l}})),0===me.value.length&&Object.keys(l).length>2&&i.info("未找到符合筛选条件的记录")}else me.value=[],Object.keys(l).length>2&&i.warning("未找到符合条件的记录")}catch(a){throw a}}catch(l){i.error("加载停机记录失败: "+(l.message||"未知错误")),me.value=[]}finally{ve.value=!1}},Ae=async()=>{try{const e=await n.getDowntimeTypes();e&&(ue.value=e||[])}catch(e){ue.value=[{code:"PLANNED",name:"计划停机"},{code:"UNPLANNED",name:"非计划停机"},{code:"MAINTENANCE",name:"维护停机"}]}},Ve=async e=>{e||(e="PLANNED");try{const a=await n.getDowntimeReasons(e);a&&(oe.value=a||[])}catch(a){const l={PLANNED:[{code:"MAINTENANCE",name:"定期维护"},{code:"ADJUSTMENT",name:"设备调整"},{code:"CHANGEOVER",name:"产品切换"}],UNPLANNED:[{code:"EQUIPMENT",name:"设备故障"},{code:"MATERIAL",name:"材料问题"},{code:"QUALITY",name:"质量问题"},{code:"UTILITY",name:"公共设施故障"}],MAINTENANCE:[{code:"BREAKDOWN",name:"设备损坏"},{code:"INSPECTION",name:"安全检查"},{code:"REPAIR",name:"修复工作"}]};oe.value=l[e]||l.PLANNED}},Re=async e=>{const a=ue.value.find((a=>a.code===e));De.value.type_name=a?a.name:"PLANNED"===e?"计划停机":"UNPLANNED"===e?"非计划停机":"MAINTENANCE"===e?"维护停机":e,De.value.reason_code="",De.value.reason_name="";try{await Ve(e)}catch(l){i.error("加载停机原因失败，请刷新页面重试")}},Ie=()=>{const e=oe.value.find((e=>e.code===De.value.reason_code));e&&(De.value.reason_name=e.name)},Ce=()=>{De.value.shift=we(De.value.start_time),De.value.shift_code="白班"===De.value.shift?1:2},Te=()=>{he.value=-1,De.value=ke(),Ae(),De.value.type_code&&Ve(De.value.type_code),pe.value=!1,fe.value=!0},Le=async()=>{if(Se())try{_e.value=!0,De.value.shift||(De.value.shift=we(De.value.start_time));const e="白班"===De.value.shift?1:2;De.value.line||(De.value.line="SWI-L"),De.value.type_code||(De.value.type_code="PLANNED",De.value.type_name="计划停机"),!De.value.reason_code&&De.value.type_code&&("PLANNED"===De.value.type_code?(De.value.reason_code="MAINTENANCE",De.value.reason_name="定期维护"):"UNPLANNED"===De.value.type_code?(De.value.reason_code="EQUIPMENT",De.value.reason_name="设备故障"):"MAINTENANCE"===De.value.type_code&&(De.value.reason_code="REPAIR",De.value.reason_name="修复工作"));const a={line:De.value.line,type_code:De.value.type_code||"PLANNED",type_name:De.value.type_name||"计划停机",reason_code:De.value.reason_code||"MAINTENANCE",reason_name:De.value.reason_name||"定期维护",start_time:new Date(De.value.start_time||new Date).toISOString(),end_time:new Date(De.value.end_time||new Date).toISOString(),remark:De.value.remark||"",shift:De.value.shift,shift_code:e};-1===he.value?await n.createDowntime(a):await n.updateDowntime(De.value.down_id,a),fe.value=!1,await Ee(),i.success(-1===he.value?"停机单创建成功":"停机单更新成功")}catch(e){i.error("保存停机记录失败: "+(e.message||"未知错误"))}finally{_e.value=!1}else i.error("请填写所有必填字段")},Se=()=>!!De.value.line&&(De.value.type_code||(De.value.type_code="PLANNED",De.value.type_name="计划停机"),!(!De.value.start_time||!De.value.end_time)),Me=async()=>{try{await n.deleteDowntime(ge.value.down_id),await Ee(),i.success("停机单删除成功")}catch(e){i.error("删除停机记录失败")}finally{ye.value=!1,ge.value=null}},Ue=e=>{if(!e)return"-";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")},Pe=(e,a)=>{if(!e||!a)return"-";try{let l,t;if(l=new Date(e),t=new Date(a),isNaN(l.getTime())||isNaN(t.getTime()))return"-";const n=t-l;if(n<0)return"-";const i=Math.floor(n/6e4);if(i<60)return`${i}分钟`;const u=Math.floor(i/60),o=i%60;return`${u}小时${o>0?` ${o}分钟`:""}`}catch(l){return"-"}},We=e=>({"SWI-L":"indigo","SWI-R":"deep-purple","RWH-L":"teal","RWH-R":"cyan",W01:"blue",HF:"deep-orange",LC:"green"}[e]||"grey"),$e=x([]),He=x(!1),je=x(!1),ze=x(!1),Oe=()=>{if(0!==me.value.length)try{ze.value=!0;let e=["线体","停机类型","停机原因","开始时间","结束时间","持续时间","班次","备注"].join(",")+"\n";me.value.forEach((a=>{const l=[a.line,a.type_name||"-",a.reason_name||"-",Ue(a.start_time),Ue(a.end_time),Pe(a.start_time,a.end_time),a.shift,(a.remark||"").replace(/,/g,"，").replace(/\n/g," ")];e+=l.join(",")+"\n"}));const a=new Blob([e],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),t=URL.createObjectURL(a),n=(new Date).toISOString().split("T")[0];l.setAttribute("href",t),l.setAttribute("download",`停机单记录_${n}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),i.success("导出CSV成功")}catch(e){i.error("导出CSV失败")}finally{ze.value=!1}else i.warning("没有数据可导出")},Fe=()=>{0!==$e.value.length?He.value=!0:i.warning("请先选择要删除的记录")},Be=async()=>{if(0!==$e.value.length)try{je.value=!0;const e=$e.value.map((e=>n.deleteDowntime(e.down_id)));await Promise.all(e),await Ee(),i.success(`成功删除 ${$e.value.length} 条停机记录`),$e.value=[]}catch(e){i.error("批量删除失败: "+(e.message||""))}finally{je.value=!1,He.value=!1}else He.value=!1},Qe=()=>{if(0===me.value.length)return"0分钟";let e=0;if(me.value.forEach(((a,l)=>{if(!a.start_time||!a.end_time)return;let t,n;try{if(t=(a.start_time,new Date(a.start_time)),n=(a.end_time,new Date(a.end_time)),isNaN(t.getTime())||isNaN(n.getTime()))return;const l=n-t;if(l>0){const a=Math.floor(l/6e4);e+=a}}catch(i){}})),e<60)return`${e}分钟`;const a=Math.floor(e/60),l=e%60;return`${a}小时${l>0?` ${l}分钟`:""}`},Ye=()=>{if(0===me.value.length)return"0分钟";let e=0,a=0;if(me.value.forEach((l=>{if(l.start_time&&l.end_time)try{let t,n;if(t=(l.start_time,new Date(l.start_time)),n=(l.end_time,new Date(l.end_time)),isNaN(t.getTime())||isNaN(n.getTime()))return;const i=n-t;i>0&&(e+=Math.floor(i/6e4),a++)}catch(t){}})),0===a)return"0分钟";const l=Math.round(e/a);if(l<60)return`${l}分钟`;const t=l%60;return`${Math.floor(l/60)}小时${t>0?` ${t}分钟`:""}`},Ke=()=>{Ee()};return A((()=>{Ee(),Ae()})),(e,a)=>{const n=V("permission");return I(),R(t,{title:"停机单管理",icon:"mdi-clipboard-text",color:"primary"},{"header-actions":C((()=>[j((I(),R(d,{color:"primary","prepend-icon":"mdi-plus",onClick:Te},{default:C((()=>a[21]||(a[21]=[U(" 新建停机单 ")]))),_:1,__:[21]})),[[n,"MAINT:WRITE"]]),T(d,{color:"success","prepend-icon":"mdi-file-export",class:"ml-2",loading:ze.value,disabled:!me.value.length,onClick:Oe},{default:C((()=>a[22]||(a[22]=[U(" 导出CSV ")]))),_:1,__:[22]},8,["loading","disabled"])])),default:C((()=>[T(u,{class:"mb-4"},{default:C((()=>[T(o,null,{default:C((()=>[S("div",z,[S("div",O,[a[24]||(a[24]=S("div",{class:"text-subtitle-1 me-2"}," 线体: ",-1)),T(s,{modelValue:de.value.line,"onUpdate:modelValue":a[0]||(a[0]=e=>de.value.line=e),color:"primary",density:"comfortable",class:"mx-2"},{default:C((()=>[T(d,{value:""},{default:C((()=>a[23]||(a[23]=[U(" 全部 ")]))),_:1,__:[23]}),(I(),M(P,null,W(ie,(e=>T(d,{key:e.value,value:e.value,color:We(e.value)},{default:C((()=>[U($(e.title),1)])),_:2},1032,["value","color"]))),64))])),_:1},8,["modelValue"])]),S("div",F,[a[28]||(a[28]=S("div",{class:"text-subtitle-1 me-2"}," 班次: ",-1)),T(s,{modelValue:de.value.shift,"onUpdate:modelValue":a[1]||(a[1]=e=>de.value.shift=e),color:"secondary",density:"comfortable",class:"mx-2"},{default:C((()=>[T(d,{value:""},{default:C((()=>a[25]||(a[25]=[U(" 全部 ")]))),_:1,__:[25]}),T(d,{value:"白班"},{default:C((()=>a[26]||(a[26]=[U(" 白班 ")]))),_:1,__:[26]}),T(d,{value:"夜班"},{default:C((()=>a[27]||(a[27]=[U(" 夜班 ")]))),_:1,__:[27]})])),_:1},8,["modelValue"])]),S("div",B,[a[29]||(a[29]=S("div",{class:"text-subtitle-1 me-2"}," 日期范围: ",-1)),T(r,{modelValue:re.value,"onUpdate:modelValue":a[4]||(a[4]=e=>re.value=e),"close-on-content-click":!1},{activator:C((({props:e})=>[T(d,H({variant:"outlined",color:"primary"},e,{class:"date-range-btn","prepend-icon":"mdi-calendar"}),{default:C((()=>[U($(ce.value),1)])),_:2},1040)])),default:C((()=>[T(c,{modelValue:de.value.dateRange,"onUpdate:modelValue":[a[2]||(a[2]=e=>de.value.dateRange=e),a[3]||(a[3]=e=>re.value=!1)],range:"",color:"primary"},null,8,["modelValue"])])),_:1},8,["modelValue"])]),T(m),S("div",Q,[T(v,{modelValue:se.value,"onUpdate:modelValue":a[5]||(a[5]=e=>se.value=e),"append-icon":"mdi-magnify",label:"搜索","hide-details":"",density:"compact",class:"me-2",style:{"max-width":"200px"}},null,8,["modelValue"]),T(d,{color:"primary",variant:"outlined",class:"me-2","prepend-icon":"mdi-filter",loading:ve.value,onClick:Ke},{default:C((()=>a[30]||(a[30]=[U(" 应用筛选 ")]))),_:1,__:[30]},8,["loading"]),T(d,{color:"secondary",variant:"outlined","prepend-icon":"mdi-refresh",onClick:xe},{default:C((()=>a[31]||(a[31]=[U(" 重置 ")]))),_:1,__:[31]})])])])),_:1})])),_:1}),T(_,{class:"mt-2 mb-4"},{default:C((()=>[T(f,{cols:"12"},{default:C((()=>[S("div",Y,[a[35]||(a[35]=S("div",{class:"text-subtitle-2 me-2"}," 当前筛选: ",-1)),T(y,{class:"me-2 mb-1",color:de.value.line?We(de.value.line):"grey",size:"small",label:""},{default:C((()=>{var e;return[U($(de.value.line?(null==(e=ie.find((e=>e.value===de.value.line)))?void 0:e.title)||de.value.line:"全部线体"),1)]})),_:1},8,["color"]),de.value.shift?(I(),R(y,{key:0,class:"me-2 mb-1",color:"白班"===de.value.shift?"amber-darken-1":"blue-darken-3",size:"small",label:""},{default:C((()=>[U($(de.value.shift),1)])),_:1},8,["color"])):(I(),R(y,{key:1,class:"me-2 mb-1",color:"grey",size:"small",label:""},{default:C((()=>a[32]||(a[32]=[U(" 全部班次 ")]))),_:1,__:[32]})),de.value.dateRange&&2===de.value.dateRange.length?(I(),R(y,{key:2,class:"me-2 mb-1",color:"primary",size:"small",label:""},{default:C((()=>[U($(ce.value),1)])),_:1})):L("",!0),T(m),T(d,{icon:"",variant:"text",color:"primary",loading:ve.value,class:"me-2",onClick:Ke},{default:C((()=>[T(p,null,{default:C((()=>a[33]||(a[33]=[U("mdi-refresh")]))),_:1,__:[33]}),T(h,{activator:"parent"},{default:C((()=>a[34]||(a[34]=[U(" 刷新数据 ")]))),_:1,__:[34]})])),_:1},8,["loading"]),me.value.length>0?(I(),R(y,{key:3,color:"info",size:"small",class:"me-2"},{default:C((()=>[U(" 共 "+$(me.value.length)+" 条记录 ",1)])),_:1})):L("",!0)])])),_:1})])),_:1}),me.value.length>0?(I(),R(u,{key:0,class:"mb-4"},{default:C((()=>[T(o,{class:"py-2"},{default:C((()=>[T(_,null,{default:C((()=>[T(f,{cols:"12",md:"4"},{default:C((()=>[S("div",K,[T(p,{color:"primary",class:"me-2"},{default:C((()=>a[36]||(a[36]=[U(" mdi-clock-outline ")]))),_:1,__:[36]}),S("div",null,[a[37]||(a[37]=S("div",{class:"text-subtitle-2"}," 总停机时间 ",-1)),S("div",G,$(Qe()),1)])])])),_:1}),T(f,{cols:"12",md:"4"},{default:C((()=>[S("div",J,[T(p,{color:"warning",class:"me-2"},{default:C((()=>a[38]||(a[38]=[U(" mdi-counter ")]))),_:1,__:[38]}),S("div",null,[a[39]||(a[39]=S("div",{class:"text-subtitle-2"}," 停机次数 ",-1)),S("div",X,$(me.value.length)+" 次 ",1)])])])),_:1}),T(f,{cols:"12",md:"4"},{default:C((()=>[S("div",Z,[T(p,{color:"success",class:"me-2"},{default:C((()=>a[40]||(a[40]=[U(" mdi-chart-timeline-variant ")]))),_:1,__:[40]}),S("div",null,[a[41]||(a[41]=S("div",{class:"text-subtitle-2"}," 平均每次停机时间 ",-1)),S("div",q,$(Ye()),1)])])])),_:1})])),_:1})])),_:1})])),_:1})):L("",!0),T(l,{selected:$e.value,"onUpdate:selected":a[6]||(a[6]=e=>$e.value=e),headers:ne,items:me.value,loading:ve.value,search:se.value,"items-per-page":10,"show-select":""},{top:C((()=>[$e.value.length>0?(I(),M("div",ee,[T(y,{color:"primary",class:"mr-2"},{default:C((()=>[U(" 已选择 "+$($e.value.length)+" 项 ",1)])),_:1}),j((I(),R(d,{color:"error",variant:"outlined",size:"small","prepend-icon":"mdi-delete-sweep",onClick:Fe},{default:C((()=>a[42]||(a[42]=[U(" 批量删除 ")]))),_:1,__:[42]})),[[n,"MAINT:ADMIN"]])])):L("",!0)])),"item.line":C((({item:e})=>[T(y,{color:We(e.line),size:"small",class:"text-white"},{default:C((()=>[U($(e.line),1)])),_:2},1032,["color"])])),"item.type_name":C((({item:e})=>[U($(e.type_name||"-"),1)])),"item.reason_name":C((({item:e})=>[U($(e.reason_name||"-"),1)])),"item.start_time":C((({item:e})=>[U($(Ue(e.start_time)),1)])),"item.end_time":C((({item:e})=>[U($(Ue(e.end_time)),1)])),"item.duration":C((({item:e})=>[U($(Pe(e.start_time,e.end_time)),1)])),"item.shift":C((({item:e})=>[T(y,{color:"白班"===e.shift?"amber-darken-1":"blue-darken-3",size:"small",class:"text-white"},{default:C((()=>[U($(e.shift),1)])),_:2},1032,["color"])])),"item.actions":C((({item:e})=>[T(d,{icon:"",variant:"text",size:"small",color:"primary",onClick:a=>{return l=e,he.value=me.value.indexOf(l),De.value={...l,start_time:be(new Date(l.start_time)),end_time:be(new Date(l.end_time)),shift:l.shift||(1===l.shift_code?"白班":"夜班"),shift_code:l.shift_code||("白班"===l.shift?1:2),type_code:l.type_code||"PLANNED",type_name:l.type_name||"计划停机"},pe.value=!0,void(fe.value=!0);var l}},{default:C((()=>[T(p,null,{default:C((()=>a[43]||(a[43]=[U("mdi-eye")]))),_:1,__:[43]})])),_:2},1032,["onClick"]),j((I(),R(d,{icon:"",variant:"text",size:"small",color:"primary",onClick:a=>{return l=e,he.value=me.value.indexOf(l),De.value={...l,start_time:be(new Date(l.start_time)),end_time:be(new Date(l.end_time)),shift:l.shift||(1===l.shift_code?"白班":"夜班"),shift_code:l.shift_code||("白班"===l.shift?1:2),type_code:l.type_code||"PLANNED",type_name:l.type_name||"计划停机"},Ve(De.value.type_code),pe.value=!1,void(fe.value=!0);var l}},{default:C((()=>[T(p,null,{default:C((()=>a[44]||(a[44]=[U("mdi-pencil")]))),_:1,__:[44]})])),_:2},1032,["onClick"])),[[n,"MAINT:WRITE"]]),j((I(),R(d,{icon:"",variant:"text",size:"small",color:"error",onClick:a=>{return l=e,ge.value=l,void(ye.value=!0);var l}},{default:C((()=>[T(p,null,{default:C((()=>a[45]||(a[45]=[U("mdi-delete")]))),_:1,__:[45]})])),_:2},1032,["onClick"])),[[n,"MAINT:ADMIN"]])])),_:1},8,["selected","items","loading","search"]),T(g,{modelValue:fe.value,"onUpdate:modelValue":a[16]||(a[16]=e=>fe.value=e),"max-width":"800px"},{default:C((()=>[T(u,null,{default:C((()=>[T(N,{class:"d-flex align-center"},{default:C((()=>[S("span",null,$(Ne.value),1),T(m),T(d,{icon:"",onClick:a[7]||(a[7]=e=>fe.value=!1)},{default:C((()=>[T(p,null,{default:C((()=>a[46]||(a[46]=[U("mdi-close")]))),_:1,__:[46]})])),_:1})])),_:1}),T(o,null,{default:C((()=>[pe.value?(I(),M("div",ae,[T(b,{type:"info",text:"",density:"compact",variant:"tonal",class:"mb-2"},{default:C((()=>a[47]||(a[47]=[U(" 此功能主要用于数据浏览，仅在需要添加备注时才使用编辑功能。 ")]))),_:1,__:[47]})])):L("",!0),T(w,{ref:"recordForm"},{default:C((()=>[T(_,null,{default:C((()=>[T(f,{cols:"12",md:"6"},{default:C((()=>[T(k,{modelValue:De.value.line,"onUpdate:modelValue":a[8]||(a[8]=e=>De.value.line=e),items:ie,label:"线体",variant:"outlined",rules:pe.value?[]:[e=>!!e||"请选择线体"],readonly:pe.value,"item-value":"value","item-title":"title","return-object":!1},null,8,["modelValue","rules","readonly"])])),_:1}),T(f,{cols:"12",md:"6"},{default:C((()=>[T(k,{modelValue:De.value.type_code,"onUpdate:modelValue":[a[9]||(a[9]=e=>De.value.type_code=e),Re],items:ue.value,"item-title":"name","item-value":"code",label:"停机类型",variant:"outlined",rules:pe.value?[]:[e=>!!e||"请选择停机类型"],readonly:pe.value,"return-object":!1},null,8,["modelValue","items","rules","readonly"])])),_:1})])),_:1}),T(_,null,{default:C((()=>[T(f,{cols:"12",md:"6"},{default:C((()=>[T(k,{modelValue:De.value.reason_code,"onUpdate:modelValue":[a[10]||(a[10]=e=>De.value.reason_code=e),Ie],items:oe.value,"item-title":"name","item-value":"code",label:"停机原因",variant:"outlined",rules:pe.value?[]:[e=>!!e||"请选择停机原因"],readonly:pe.value,"return-object":!1},null,8,["modelValue","items","rules","readonly"])])),_:1}),T(f,{cols:"12",md:"6"},{default:C((()=>[T(v,{modelValue:De.value.remark,"onUpdate:modelValue":a[11]||(a[11]=e=>De.value.remark=e),label:"备注",variant:"outlined",readonly:pe.value},null,8,["modelValue","readonly"])])),_:1})])),_:1}),T(_,null,{default:C((()=>[T(f,{cols:"12",md:"6"},{default:C((()=>[T(v,{modelValue:De.value.start_time,"onUpdate:modelValue":[a[12]||(a[12]=e=>De.value.start_time=e),Ce],label:"开始时间",type:"datetime-local",variant:"outlined",rules:pe.value?[]:[e=>!!e||"请选择开始时间"],readonly:pe.value},null,8,["modelValue","rules","readonly"])])),_:1}),T(f,{cols:"12",md:"6"},{default:C((()=>[T(v,{modelValue:De.value.end_time,"onUpdate:modelValue":a[13]||(a[13]=e=>De.value.end_time=e),label:"结束时间",type:"datetime-local",variant:"outlined",rules:pe.value?[]:[e=>!!e||"请选择结束时间",e=>!e||!De.value.start_time||new Date(e)>new Date(De.value.start_time)||"结束时间必须晚于开始时间"],readonly:pe.value},null,8,["modelValue","rules","readonly"])])),_:1})])),_:1}),pe.value?(I(),R(_,{key:0},{default:C((()=>[T(f,{cols:"12",md:"6"},{default:C((()=>[T(u,{variant:"outlined",class:"pa-3"},{default:C((()=>[a[48]||(a[48]=S("div",{class:"text-subtitle-2 mb-1"}," 持续时间 ",-1)),S("div",le,$(Pe(De.value.start_time,De.value.end_time)),1)])),_:1,__:[48]})])),_:1})])),_:1})):L("",!0),T(_,null,{default:C((()=>[T(f,{cols:"12",md:"6"},{default:C((()=>[T(y,{class:"mt-2",color:"白班"===De.value.shift?"amber-darken-1":"blue-darken-3",size:"large",label:""},{default:C((()=>[U(" 班次: "+$(De.value.shift)+" ",1),T(h,{activator:"parent",location:"end"},{default:C((()=>a[49]||(a[49]=[U(" 班次根据开始时间自动判断：7:30-19:30为白班，其余为夜班 ")]))),_:1,__:[49]})])),_:1},8,["color"])])),_:1})])),_:1})])),_:1},512)])),_:1}),T(D,null,{default:C((()=>[T(m),T(d,{color:"grey",text:"",onClick:a[14]||(a[14]=e=>fe.value=!1)},{default:C((()=>[U($(pe.value?"关闭":"取消"),1)])),_:1}),pe.value?j((I(),R(d,{key:0,color:"primary",onClick:a[15]||(a[15]=e=>pe.value=!1)},{default:C((()=>a[50]||(a[50]=[U(" 编辑备注 ")]))),_:1,__:[50]})),[[n,"MAINT:WRITE"]]):(I(),R(d,{key:1,color:"primary",loading:_e.value,disabled:_e.value,onClick:Le},{default:C((()=>a[51]||(a[51]=[U(" 保存 ")]))),_:1,__:[51]},8,["loading","disabled"]))])),_:1})])),_:1})])),_:1},8,["modelValue"]),T(g,{modelValue:ye.value,"onUpdate:modelValue":a[18]||(a[18]=e=>ye.value=e),"max-width":"400"},{default:C((()=>[T(u,null,{default:C((()=>[T(N,{class:"headline"},{default:C((()=>a[52]||(a[52]=[U(" 确认删除 ")]))),_:1,__:[52]}),T(o,null,{default:C((()=>a[53]||(a[53]=[U(" 您确定要删除这条停机记录吗？此操作不可撤销。 ")]))),_:1,__:[53]}),T(D,null,{default:C((()=>[T(m),T(d,{color:"grey",text:"",onClick:a[17]||(a[17]=e=>ye.value=!1)},{default:C((()=>a[54]||(a[54]=[U(" 取消 ")]))),_:1,__:[54]}),T(d,{color:"error",text:"",onClick:Me},{default:C((()=>a[55]||(a[55]=[U(" 删除 ")]))),_:1,__:[55]})])),_:1})])),_:1})])),_:1},8,["modelValue"]),T(g,{modelValue:He.value,"onUpdate:modelValue":a[20]||(a[20]=e=>He.value=e),"max-width":"450"},{default:C((()=>[T(u,null,{default:C((()=>[T(N,{class:"headline"},{default:C((()=>a[56]||(a[56]=[U(" 批量删除确认 ")]))),_:1,__:[56]}),T(o,null,{default:C((()=>[U(" 您确定要删除选中的 "+$($e.value.length)+" 条停机记录吗？此操作不可撤销。 ",1)])),_:1}),T(D,null,{default:C((()=>[T(m),T(d,{color:"grey",text:"",onClick:a[19]||(a[19]=e=>He.value=!1)},{default:C((()=>a[57]||(a[57]=[U(" 取消 ")]))),_:1,__:[57]}),T(d,{color:"error",text:"",loading:je.value,disabled:je.value,onClick:Be},{default:C((()=>a[58]||(a[58]=[U(" 删除 ")]))),_:1,__:[58]},8,["loading","disabled"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}};export{te as default};
