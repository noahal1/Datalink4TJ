import{_ as a,u as l,c as e,U as t,d as s,p as u,M as d,i as n}from"./entry-index.D92NaooR.js";import{a as o}from"./chunk-utils-vendor.DVew6AbD.js";import{z as r,A as i,Z as c,j as v,a9 as m,k as _,$ as p,m as y,f,l as h,V as g,e as x,g as b,a1 as w,h as k,ai as V,aj as U,ak as C,v as z,al as O,am as D,an as j,_ as A,ao as S,ap as F,aq as H,ar as $,o as E,w as I,q as N,r as B,as as J}from"./chunk-vue-core.CxEQweee.js";import{r as L,d as R,w as T,N as q,ae as M,ac as K,ad as X,K as Z,H as G,a4 as P,X as Q,ab as W,af as Y,F as aa,ag as la}from"./chunk-vendors.D0_dqILu.js";import"./chunk-chart-core.HkgdsJMe.js";const ea={class:"controls-bar mb-4"},ta={class:"table-container"},sa={class:"text-center font-weight-medium",style:{"min-width":"120px"}},ua={class:"text-center",style:{"min-width":"120px"}},da={style:{"min-width":"200px"}},na={style:{"min-width":"140px"},class:"editable-cell"},oa={class:"text-center",style:{"min-width":"160px"}},ra={class:"safety-range"},ia={class:"text-grey-600"},ca={class:"text-center",style:{"min-width":"100px"}},va={class:"text-center",style:{"min-width":"120px"}},ma={class:"mb-4"},_a={class:"pa-4"},pa={class:"d-flex align-center"},ya={class:"pa-4"},fa={key:0,class:"text-center py-8"},ha={key:1},ga={class:"d-flex align-center"},xa={key:0,class:"mb-4"},ba={key:1,class:"mb-4"},wa={key:2},ka={class:"pa-4"},Va={key:0,class:"text-center py-8"},Ua={key:1},Ca={class:"d-flex align-center"},za={class:"text-h4"},Oa={class:"text-h4"},Da={class:"text-h4"},ja={class:"text-h4"},Aa={key:0},Sa=a({__name:"DohDaily",setup(a){const Sa=l(),Fa=L(!1),Ha=L(!1),$a=L(!1),Ea=L(!1),Ia=L(!1),Na=L((new Date).toISOString().split("T")[0]),Ba=L("all"),Ja=L(!1),La=L(null),Ra=L({min_safety_days:0,max_safety_days:0}),Ta=L(!1),qa=L(1),Ma=L(null),Ka=L((new Date).toISOString().split("T")[0]),Xa=L(!1),Za=L(!1),Ga=L(!1),Pa=L(!1),Qa=L(null),Wa=L(null),Ya=[a=>!!a||"请选择文件",a=>!a||a.size<10485760||"文件大小不能超过10MB",a=>!a||["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(a.type)||"只支持Excel文件格式"],al=R((()=>{if(!Ma.value)return!1;const a=Array.isArray(Ma.value)?Ma.value[0]:Ma.value;return a&&a instanceof File})),ll=L([]),el=L([]),tl=L([]),sl=[{title:"分类",key:"category",width:"120px",sortable:!1},{title:"产品编码",key:"product_code",width:"120px",sortable:!1},{title:"产品名称",key:"product_name",width:"200px",sortable:!1},{title:"当前库存天数",key:"doh_value",width:"140px",sortable:!1},{title:"安全库存范围",key:"safety_range",width:"160px",sortable:!1},{title:"状态",key:"status",width:"100px",sortable:!1},{title:"操作",key:"actions",width:"120px",sortable:!1}],ul=R((()=>{let a=ll.value;return"all"!==Ba.value&&(a=a.filter((a=>a.category===Ba.value))),a.sort(((a,l)=>{const e={"原材料":1,"半成品":2,"成品":3},t=e[a.category]-e[l.category];return 0!==t?t:(a.sort_order||0)-(l.sort_order||0)}))})),dl=a=>({normal:"正常",low:"偏低",high:"偏高"}[a]||"未知"),nl=async(a=Na.value)=>{var l,e;Fa.value=!0;try{const l={target_date:a},e=await n("/doh/v2/daily",{params:l});ll.value=e.data||[],el.value=JSON.parse(JSON.stringify(ll.value)),Ea.value=!1,Ia.value=!1,await ol(a)}catch(t){d.error("获取DOH数据失败: "+((null==(e=null==(l=t.response)?void 0:l.data)?void 0:e.detail)||t.message))}finally{Fa.value=!1}},ol=async(a=Na.value)=>{try{const l={target_date:a},e=await n("/doh/v2/summary",{params:l});tl.value=e.data||[]}catch(l){}},rl=async()=>{var a,l;Ha.value=!0;try{const a={record_date:Na.value,records:ll.value.map((a=>({master_data_id:a.id,record_date:Na.value,doh_value:a.doh_value||0})))},l=await u("/doh/v2/daily",a);l&&l.data?(d.success("DOH数据保存成功"),el.value=JSON.parse(JSON.stringify(ll.value)),Ea.value=!1,Ia.value=!1,await ol()):d.error("保存失败: 服务器响应格式不正确")}catch(e){d.error("保存失败: "+((null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.detail)||e.message))}finally{Ha.value=!1}},il=()=>{nl()},cl=()=>{nl()},vl=async()=>{var a,l;if(La.value){$a.value=!0;try{const a={min_safety_days:parseFloat(Ra.value.min_safety_days)||0,max_safety_days:parseFloat(Ra.value.max_safety_days)||0},l=await u(`/doh/v2/master-data/${La.value.id}/safety-stock`,a);if(l&&l.data){d.success("安全库存设置保存成功");const l=ll.value.findIndex((a=>a.id===La.value.id));if(-1!==l){ll.value[l].min_safety_days=a.min_safety_days,ll.value[l].max_safety_days=a.max_safety_days;const e=ll.value[l].doh_value||0;let t="normal";a.min_safety_days>0&&e<a.min_safety_days?t="low":a.max_safety_days>0&&e>a.max_safety_days&&(t="high"),ll.value[l].status=t}Ja.value=!1}else d.error("保存失败: 服务器响应格式不正确")}catch(e){d.error("保存失败: "+((null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.detail)||e.message))}finally{$a.value=!1}}};T(Na,(a=>{a&&cl()}));const ml=()=>{Ta.value=!0,qa.value=1,Ma.value=null,Ka.value=Na.value,Xa.value=!1,Qa.value=null,Wa.value=null,Za.value=!1,Ga.value=!1},_l=()=>{Ta.value=!1,qa.value=1,Ma.value=null,Qa.value=null,Wa.value=null},pl=async()=>{var a,l;Pa.value=!0;try{const a=await n("/doh/v2/excel/template",{responseType:"blob"}),l=new Blob([a.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e=window.URL.createObjectURL(l),t=document.createElement("a");t.href=e,t.download="DOH导入模板.xlsx",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e),d.success("模板下载成功")}catch(e){d.error("下载模板失败: "+((null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.detail)||e.message))}finally{Pa.value=!1}},yl=async()=>{var a,l;if(!Ma.value||!Ka.value)return void d.error("请选择文件和导入日期");const e=Array.isArray(Ma.value)?Ma.value[0]:Ma.value;if(e)if(Sa.token){Za.value=!0;try{const a=new FormData;a.append("file",e);const l="http://localhost:8000/api/v1",t=await o.post(`${l}/doh/v2/excel/validate`,a,{headers:{Authorization:`Bearer ${Sa.token}`}});Qa.value=t.data,Qa.value.is_valid?(d.success("文件验证通过"),qa.value=2):(d.error("文件验证失败，请检查错误信息"),qa.value=2)}catch(t){d.error("文件验证失败: "+((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.detail)||t.message))}finally{Za.value=!1}}else d.error("用户未登录，请刷新页面重新登录");else d.error("请选择有效的文件")},fl=async()=>{var a,l,e;if(!(null==(a=Qa.value)?void 0:a.is_valid))return void d.error("请先通过文件验证");const t=Array.isArray(Ma.value)?Ma.value[0]:Ma.value;if(t)if(Sa.token){Ga.value=!0;try{const a=new FormData;a.append("file",t),a.append("record_date",Ka.value),a.append("overwrite_existing",Xa.value);const l="http://localhost:8000/api/v1",e=await o.post(`${l}/doh/v2/excel/import`,a,{headers:{Authorization:`Bearer ${Sa.token}`}});Wa.value=e.data,Wa.value.success?(d.success("数据导入成功"),qa.value=3,Ka.value===Na.value&&await nl()):(d.error("数据导入失败"),qa.value=3)}catch(s){d.error("数据导入失败: "+((null==(e=null==(l=s.response)?void 0:l.data)?void 0:e.detail)||s.message))}finally{Ga.value=!1}}else d.error("用户未登录，请刷新页面重新登录");else d.error("请选择有效的文件")},hl=()=>{var a;_l(),(null==(a=Wa.value)?void 0:a.success)&&d.success(`导入完成！成功处理 ${Wa.value.imported_rows+Wa.value.updated_rows} 条数据`)};return q((()=>{cl()})),(a,l)=>(K(),M(s,{title:"DOH每日填报",icon:"mdi-package-variant",color:"info"},{default:X((()=>[Z("div",ea,[G(r,{class:"align-center"},{default:X((()=>[G(i,{cols:"12",md:"4"},{default:X((()=>[G(c,{modelValue:Na.value,"onUpdate:modelValue":[l[0]||(l[0]=a=>Na.value=a),cl],type:"date",variant:"outlined",density:"compact",label:"选择日期","hide-details":""},null,8,["modelValue"])])),_:1}),G(v),G(i,{cols:"auto"},{default:X((()=>[G(m,{modelValue:Ba.value,"onUpdate:modelValue":l[1]||(l[1]=a=>Ba.value=a),density:"comfortable",color:"info",mandatory:""},{default:X((()=>[G(_,{value:"all","prepend-icon":"mdi-view-grid"},{default:X((()=>l[14]||(l[14]=[P(" 全部 ")]))),_:1,__:[14]}),G(_,{value:"原材料","prepend-icon":"mdi-cube-outline"},{default:X((()=>l[15]||(l[15]=[P(" 原材料 ")]))),_:1,__:[15]}),G(_,{value:"半成品","prepend-icon":"mdi-package"},{default:X((()=>l[16]||(l[16]=[P(" 半成品 ")]))),_:1,__:[16]}),G(_,{value:"成品","prepend-icon":"mdi-package-variant-closed"},{default:X((()=>l[17]||(l[17]=[P(" 成品 ")]))),_:1,__:[17]})])),_:1},8,["modelValue"]),G(_,{"prepend-icon":"mdi-content-save",color:"primary",class:"ml-2",loading:Ha.value,disabled:!Ea.value,onClick:rl},{default:X((()=>l[18]||(l[18]=[P(" 保存 ")]))),_:1,__:[18]},8,["loading","disabled"]),G(_,{"prepend-icon":"mdi-refresh",variant:"text",class:"ml-2",loading:Fa.value,onClick:il},{default:X((()=>l[19]||(l[19]=[P(" 刷新 ")]))),_:1,__:[19]},8,["loading"]),G(_,{"prepend-icon":"mdi-file-excel",color:"success",variant:"outlined",class:"ml-2",onClick:ml},{default:X((()=>l[20]||(l[20]=[P(" Excel导入 ")]))),_:1,__:[20]})])),_:1})])),_:1})]),G(e,{loading:Fa.value,message:"加载数据中..."},null,8,["loading"]),Z("div",ta,[G(t,{headers:sl,items:ul.value,loading:Fa.value,class:"mt-4 doh-table doh-data-table",hover:""},{item:X((({item:a})=>{return[Z("tr",null,[Z("td",sa,[G(p,{color:(e=a.category,{"原材料":"orange","半成品":"blue","成品":"green"}[e]||"grey"),size:"small",variant:"tonal"},{default:X((()=>[P(Q(a.category),1)])),_:2},1032,["color"])]),Z("td",ua,Q(a.product_code),1),Z("td",da,Q(a.product_name),1),Z("td",na,[G(c,{modelValue:a.doh_value,"onUpdate:modelValue":l=>a.doh_value=l,variant:"outlined",density:"compact",type:"number",step:"0.1",min:"0","hide-details":"",class:"ma-1",suffix:"天",onInput:l=>(a=>{try{null!==a.doh_value&&void 0!==a.doh_value&&""!==a.doh_value&&(a.doh_value=parseFloat(a.doh_value)||0),Ea.value=!0,Ia.value=!0}catch(l){}})(a)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),Z("td",oa,[Z("div",ra,[Z("small",ia,Q(a.min_safety_days||0)+" - "+Q(a.max_safety_days||0)+" 天 ",1)])]),Z("td",ca,[G(p,{color:(l=a.status,{normal:"success",low:"warning",high:"error"}[l]||"grey"),size:"small",variant:"tonal"},{default:X((()=>[P(Q(dl(a.status)),1)])),_:2},1032,["color"])]),Z("td",va,[G(_,{icon:"mdi-cog",size:"small",variant:"text",title:"设置安全库存",onClick:l=>(a=>{La.value=a,Ra.value={min_safety_days:a.min_safety_days||0,max_safety_days:a.max_safety_days||0},Ja.value=!0})(a)},null,8,["onClick"])])])];var l,e})),_:1},8,["items","loading"])]),G(y,{modelValue:Ia.value,"onUpdate:modelValue":l[3]||(l[3]=a=>Ia.value=a),timeout:0,color:"warning",location:"bottom","multi-line":""},{actions:X((()=>[G(_,{color:"white",variant:"text",loading:Ha.value,onClick:rl},{default:X((()=>l[21]||(l[21]=[P(" 保存 ")]))),_:1,__:[21]},8,["loading"]),G(_,{color:"white",variant:"text",onClick:l[2]||(l[2]=a=>Ia.value=!1)},{default:X((()=>l[22]||(l[22]=[P(" 关闭 ")]))),_:1,__:[22]})])),default:X((()=>[G(f,{icon:"mdi-alert",class:"mr-2"}),l[23]||(l[23]=P(" 数据已修改，请记得保存！ "))])),_:1,__:[23]},8,["modelValue"]),G(h,{modelValue:Ja.value,"onUpdate:modelValue":l[7]||(l[7]=a=>Ja.value=a),"max-width":"500px"},{default:X((()=>[G(g,null,{default:X((()=>[G(x,{class:"text-h6"},{default:X((()=>[G(f,{icon:"mdi-cog",class:"mr-2"}),l[24]||(l[24]=P(" 设置安全库存 "))])),_:1,__:[24]}),G(b,null,{default:X((()=>{var a,e;return[Z("div",ma,[l[25]||(l[25]=Z("strong",null,"产品：",-1)),P(Q(null==(a=La.value)?void 0:a.product_name)+" ",1),l[26]||(l[26]=Z("br",null,null,-1)),l[27]||(l[27]=Z("strong",null,"编码：",-1)),P(Q(null==(e=La.value)?void 0:e.product_code),1)]),G(r,null,{default:X((()=>[G(i,{cols:"6"},{default:X((()=>[G(c,{modelValue:Ra.value.min_safety_days,"onUpdate:modelValue":l[4]||(l[4]=a=>Ra.value.min_safety_days=a),label:"最小安全库存",type:"number",step:"0.1",min:"0",suffix:"天",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])),_:1}),G(i,{cols:"6"},{default:X((()=>[G(c,{modelValue:Ra.value.max_safety_days,"onUpdate:modelValue":l[5]||(l[5]=a=>Ra.value.max_safety_days=a),label:"最大安全库存",type:"number",step:"0.1",min:"0",suffix:"天",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])),_:1})])),_:1}),G(w,{type:"info",variant:"tonal",class:"mt-4",density:"compact"},{default:X((()=>l[28]||(l[28]=[Z("small",null," 库存预警的参考标准。当前库存天数低于最小时显示为偏低，高于最大时显示为偏高，此更改只对本产品有效。 ",-1)]))),_:1,__:[28]})]})),_:1}),G(k,null,{default:X((()=>[G(v),G(_,{variant:"text",onClick:l[6]||(l[6]=a=>Ja.value=!1)},{default:X((()=>l[29]||(l[29]=[P(" 取消 ")]))),_:1,__:[29]}),G(_,{color:"primary",loading:$a.value,onClick:vl},{default:X((()=>l[30]||(l[30]=[P(" 保存 ")]))),_:1,__:[30]},8,["loading"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),G(h,{modelValue:Ta.value,"onUpdate:modelValue":l[13]||(l[13]=a=>Ta.value=a),"max-width":"600px",persistent:""},{default:X((()=>[G(g,null,{default:X((()=>[G(x,{class:"text-h6"},{default:X((()=>[G(f,{icon:"mdi-file-excel",class:"mr-2",color:"success"}),l[31]||(l[31]=P(" Excel数据导入 "))])),_:1,__:[31]}),G(b,null,{default:X((()=>[G(V,{modelValue:qa.value,"onUpdate:modelValue":l[11]||(l[11]=a=>qa.value=a),"alt-labels":""},{default:X((()=>[G(U,null,{default:X((()=>[G(C,{title:"选择文件",value:1,complete:qa.value>1},null,8,["complete"]),G(z),G(C,{title:"验证数据",value:2,complete:qa.value>2},null,8,["complete"]),G(z),G(C,{title:"导入完成",value:3})])),_:1}),G(O,null,{default:X((()=>[G(D,{value:1},{default:X((()=>[Z("div",_a,[G(c,{modelValue:Ka.value,"onUpdate:modelValue":l[8]||(l[8]=a=>Ka.value=a),type:"date",label:"导入日期",variant:"outlined",density:"compact",class:"mb-4",rules:[a=>!!a||"请选择导入日期"]},null,8,["modelValue","rules"]),G(j,{modelValue:Ma.value,"onUpdate:modelValue":l[9]||(l[9]=a=>Ma.value=a),label:"选择Excel文件",variant:"outlined",density:"compact",accept:".xlsx,.xls","prepend-icon":"mdi-file-excel","show-size":"",class:"mb-4",rules:Ya},null,8,["modelValue"]),G(A,{modelValue:Xa.value,"onUpdate:modelValue":l[10]||(l[10]=a=>Xa.value=a),label:"覆盖已存在的数据",density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue"]),G(w,{type:"info",variant:"tonal",class:"mb-4"},{default:X((()=>[Z("div",pa,[l[33]||(l[33]=Z("div",{class:"flex-grow-1"},[Z("strong",null,"需要导入模板？"),Z("br"),Z("small",null,"下载标准的Excel模板，包含正确的表头格式")],-1)),G(_,{color:"info",variant:"outlined",size:"small",loading:Pa.value,onClick:pl},{default:X((()=>l[32]||(l[32]=[P(" 下载模板 ")]))),_:1,__:[32]},8,["loading"])])])),_:1}),G(S,{variant:"accordion",class:"mb-4"},{default:X((()=>[G(F,null,{default:X((()=>[G(H,null,{default:X((()=>[G(f,{icon:"mdi-information",class:"mr-2"}),l[34]||(l[34]=P(" 支持的表头格式 "))])),_:1,__:[34]}),G($,null,{default:X((()=>l[35]||(l[35]=[Z("div",{class:"text-body-2"},[Z("p",null,[Z("strong",null,"必需列：")]),Z("ul",null,[Z("li",null,"库存天数/DOH/doh/天数 - DOH数值"),Z("li",null,"产品编码/编码/product_code 或 产品名称/名称/product_name - 至少一个")]),Z("p",{class:"mt-2"},[Z("strong",null,"可选列：")]),Z("ul",null,[Z("li",null,"分类/类别/category - 产品分类"),Z("li",null,"备注/说明/remark - 备注信息")])],-1)]))),_:1,__:[35]})])),_:1})])),_:1})])])),_:1}),G(D,{value:2},{default:X((()=>{var a,e,t;return[Z("div",ya,[Za.value?(K(),W("div",fa,[G(E,{indeterminate:"",color:"primary",size:"64"}),l[36]||(l[36]=Z("p",{class:"mt-4"}," 正在验证数据... ",-1))])):Qa.value?(K(),W("div",ha,[G(w,{type:Qa.value.is_valid?"success":"error",variant:"tonal",class:"mb-4"},{default:X((()=>{var a;return[Z("div",ga,[G(f,{icon:Qa.value.is_valid?"mdi-check-circle":"mdi-alert-circle",class:"mr-2"},null,8,["icon"]),Z("div",null,[Z("strong",null,Q(Qa.value.is_valid?"验证通过":"验证失败"),1),l[37]||(l[37]=Z("br",null,null,-1)),Z("small",null," 共 "+Q((null==(a=Qa.value.data)?void 0:a.length)||0)+" 行有效数据 ",1)])])]})),_:1},8,["type"]),(null==(a=Qa.value.errors)?void 0:a.length)>0?(K(),W("div",xa,[G(w,{type:"error",variant:"tonal",class:"mb-2"},{default:X((()=>[Z("strong",null,"发现 "+Q(Qa.value.errors.length)+" 个错误：",1)])),_:1}),G(I,{density:"compact",class:"bg-error-lighten-5 rounded"},{default:X((()=>[(K(!0),W(aa,null,la(Qa.value.errors,((a,l)=>(K(),M(N,{key:l,class:"text-error"},{default:X((()=>[G(B,null,{default:X((()=>[G(f,{icon:"mdi-alert-circle",size:"small",class:"mr-2"}),P(" "+Q(a),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):Y("",!0),(null==(e=Qa.value.warnings)?void 0:e.length)>0?(K(),W("div",ba,[G(w,{type:"warning",variant:"tonal",class:"mb-2"},{default:X((()=>[Z("strong",null,Q(Qa.value.warnings.length)+" 个警告：",1)])),_:1}),G(I,{density:"compact",class:"bg-warning-lighten-5 rounded"},{default:X((()=>[(K(!0),W(aa,null,la(Qa.value.warnings,((a,l)=>(K(),M(N,{key:l,class:"text-warning"},{default:X((()=>[G(B,null,{default:X((()=>[G(f,{icon:"mdi-alert",size:"small",class:"mr-2"}),P(" "+Q(a),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):Y("",!0),(null==(t=Qa.value.data)?void 0:t.length)>0?(K(),W("div",wa,[l[39]||(l[39]=Z("h4",{class:"mb-2"}," 数据预览（前5行）： ",-1)),G(J,{density:"compact",class:"border rounded"},{default:X((()=>[l[38]||(l[38]=Z("thead",null,[Z("tr",null,[Z("th",null,"行号"),Z("th",null,"产品编码"),Z("th",null,"产品名称"),Z("th",null,"分类"),Z("th",null,"库存天数"),Z("th",null,"备注")])],-1)),Z("tbody",null,[(K(!0),W(aa,null,la(Qa.value.data.slice(0,5),(a=>(K(),W("tr",{key:a.row_number},[Z("td",null,Q(a.row_number),1),Z("td",null,Q(a.product_code||"-"),1),Z("td",null,Q(a.product_name||"-"),1),Z("td",null,Q(a.category||"-"),1),Z("td",null,Q(a.doh_value),1),Z("td",null,Q(a.remark||"-"),1)])))),128))])])),_:1,__:[38]})])):Y("",!0)])):Y("",!0)])]})),_:1}),G(D,{value:3},{default:X((()=>{var a;return[Z("div",ka,[Ga.value?(K(),W("div",Va,[G(E,{indeterminate:"",color:"primary",size:"64"}),l[40]||(l[40]=Z("p",{class:"mt-4"}," 正在导入数据... ",-1))])):Wa.value?(K(),W("div",Ua,[G(w,{type:Wa.value.success?"success":"error",variant:"tonal",class:"mb-4"},{default:X((()=>[Z("div",Ca,[G(f,{icon:Wa.value.success?"mdi-check-circle":"mdi-alert-circle",class:"mr-2"},null,8,["icon"]),Z("div",null,[Z("strong",null,Q(Wa.value.message),1)])])])),_:1},8,["type"]),G(r,{class:"mb-4"},{default:X((()=>[G(i,{cols:"6",md:"3"},{default:X((()=>[G(g,{variant:"tonal",color:"info"},{default:X((()=>[G(b,{class:"text-center"},{default:X((()=>[Z("div",za,Q(Wa.value.total_rows),1),l[41]||(l[41]=Z("div",{class:"text-caption"}," 总行数 ",-1))])),_:1,__:[41]})])),_:1})])),_:1}),G(i,{cols:"6",md:"3"},{default:X((()=>[G(g,{variant:"tonal",color:"success"},{default:X((()=>[G(b,{class:"text-center"},{default:X((()=>[Z("div",Oa,Q(Wa.value.imported_rows),1),l[42]||(l[42]=Z("div",{class:"text-caption"}," 新增 ",-1))])),_:1,__:[42]})])),_:1})])),_:1}),G(i,{cols:"6",md:"3"},{default:X((()=>[G(g,{variant:"tonal",color:"primary"},{default:X((()=>[G(b,{class:"text-center"},{default:X((()=>[Z("div",Da,Q(Wa.value.updated_rows),1),l[43]||(l[43]=Z("div",{class:"text-caption"}," 更新 ",-1))])),_:1,__:[43]})])),_:1})])),_:1}),G(i,{cols:"6",md:"3"},{default:X((()=>[G(g,{variant:"tonal",color:"warning"},{default:X((()=>[G(b,{class:"text-center"},{default:X((()=>[Z("div",ja,Q(Wa.value.skipped_rows),1),l[44]||(l[44]=Z("div",{class:"text-caption"}," 跳过 ",-1))])),_:1,__:[44]})])),_:1})])),_:1})])),_:1}),(null==(a=Wa.value.errors)?void 0:a.length)>0?(K(),W("div",Aa,[G(w,{type:"error",variant:"tonal",class:"mb-2"},{default:X((()=>l[45]||(l[45]=[Z("strong",null,"导入错误详情：",-1)]))),_:1,__:[45]}),G(I,{density:"compact",class:"bg-error-lighten-5 rounded"},{default:X((()=>[(K(!0),W(aa,null,la(Wa.value.errors,((a,l)=>(K(),M(N,{key:l,class:"text-error"},{default:X((()=>[G(B,null,{default:X((()=>[G(f,{icon:"mdi-alert-circle",size:"small",class:"mr-2"}),P(" "+Q(a),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])):Y("",!0)])):Y("",!0)])]})),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),G(k,null,{default:X((()=>{var a;return[G(v),1===qa.value?(K(),W(aa,{key:0},[G(_,{variant:"text",onClick:_l},{default:X((()=>l[46]||(l[46]=[P(" 取消 ")]))),_:1,__:[46]}),G(_,{color:"primary",disabled:!al.value||!Ka.value,loading:Za.value,onClick:yl},{default:X((()=>l[47]||(l[47]=[P(" 下一步 ")]))),_:1,__:[47]},8,["disabled","loading"])],64)):Y("",!0),2===qa.value?(K(),W(aa,{key:1},[G(_,{variant:"text",onClick:l[12]||(l[12]=a=>qa.value=1)},{default:X((()=>l[48]||(l[48]=[P(" 上一步 ")]))),_:1,__:[48]}),G(_,{color:"primary",disabled:!(null==(a=Qa.value)?void 0:a.is_valid),loading:Ga.value,onClick:fl},{default:X((()=>l[49]||(l[49]=[P(" 开始导入 ")]))),_:1,__:[49]},8,["disabled","loading"])],64)):Y("",!0),3===qa.value?(K(),M(_,{key:2,color:"primary",onClick:hl},{default:X((()=>l[50]||(l[50]=[P(" 完成 ")]))),_:1,__:[50]})):Y("",!0)]})),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}))}},[["__scopeId","data-v-44b8b7eb"]]);export{Sa as default};
